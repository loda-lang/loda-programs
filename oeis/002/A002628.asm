; A002628: Number of permutations of length n without 3-sequences.
; Submitted by loader3229
; 1,1,2,5,21,106,643,4547,36696,332769,3349507,37054436,446867351,5834728509,82003113550,1234297698757,19809901558841,337707109446702,6094059760690035,116052543892621951,2325905946434516516,48937614361477154273,1078523843237914046247,24846343733323674837256,597208311014983610401639,14951020245957611179725977,389230537937124948514935066,10521929552037408597109235301,294946893248925667294338590269,8562511153650469621109333740850,257130442330557720637427908082627,7978487303954788104966486620248731
; Formula: a(n) = b(n-4), a(6) = 643, a(5) = 106, a(4) = 21, a(3) = 5, a(2) = 2, a(1) = 1, a(0) = 1, b(n) = 3*n*b(n-4)+b(n-1)*(n+1)+b(n-2)*(3*n+6)+b(n-3)*(4*n+4)+b(n-5)*(n-1), b(8) = 446867351, b(7) = 37054436, b(6) = 3349507, b(5) = 332769, b(4) = 36696, b(3) = 4547, b(2) = 643, b(1) = 106, b(0) = 21

mov $2,1
mov $3,1
mov $4,2
mov $5,5
mov $6,21
lpb $0
  mul $2,$1
  rol $2,5
  mov $8,$1
  mul $8,3
  add $8,3
  mov $7,$2
  mul $7,$8
  mov $8,$1
  mul $8,4
  add $8,8
  add $6,$7
  mov $7,$3
  mul $7,$8
  mov $8,$1
  mul $8,3
  add $8,9
  add $6,$7
  mov $7,$4
  mul $7,$8
  mov $8,$1
  add $8,2
  add $6,$7
  mov $7,$5
  mul $7,$8
  sub $0,1
  add $1,1
  add $6,$7
lpe
mov $0,$2
