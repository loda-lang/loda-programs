; A124720: Number of ternary Lyndon words of length n with exactly two 1's.
; Submitted by loader3229
; 2,5,16,38,96,220,512,1144,2560,5616,12288,26592,57344,122816,262144,556928,1179648,2490112,5242880,11009536,23068672,48233472,100663296,209713152,436207616,905965568,1879048192,3892305920,8053063680,16642981888,34359738368,70866927616,146028888064,300647645184,618475290624,1271310188544,2611340115968,5360118923264,10995116277760,22539987845120,46179488366592,94557998940160,193514046488576,395824183902208,809240558043136,1653665483980800,3377699720527872,6896136921022464,14073748835532800
; Formula: a(n) = min(n-3,(n-3)%2)*c(n-3)+b(n-3), b(n) = truncate((b(n-2)*(4*d(n-2)+8))/(f(n-2)+1)), b(9) = 2560, b(8) = 2560, b(7) = 512, b(6) = 512, b(5) = 96, b(4) = 96, b(3) = 16, b(2) = 16, b(1) = 2, b(0) = 2, c(n) = truncate((b(n-2)*(2*d(n-2)+8)+c(n-2)*(2*d(n-2)+2))/(e(n-2)+1)), c(9) = 3056, c(8) = 3056, c(7) = 632, c(6) = 632, c(5) = 124, c(4) = 124, c(3) = 22, c(2) = 22, c(1) = 3, c(0) = 3, d(n) = d(n-2)+1, d(9) = 4, d(8) = 4, d(7) = 3, d(6) = 3, d(5) = 2, d(4) = 2, d(3) = 1, d(2) = 1, d(1) = 0, d(0) = 0, e(n) = e(n-2)+1, e(9) = 4, e(8) = 4, e(7) = 3, e(6) = 3, e(5) = 2, e(4) = 2, e(3) = 1, e(2) = 1, e(1) = 0, e(0) = 0, f(n) = f(n-2)+1, f(9) = 4, f(8) = 4, f(7) = 3, f(6) = 3, f(5) = 2, f(4) = 2, f(3) = 1, f(2) = 1, f(1) = 0, f(0) = 0

#offset 3

mov $1,2
mov $2,3
sub $0,3
lpb $0
  sub $0,2
  mov $4,$3
  mul $4,4
  add $4,8
  mov $6,$3
  mul $6,2
  add $6,8
  mul $6,$1
  mov $7,$3
  mul $7,2
  add $7,2
  add $8,1
  mul $2,$7
  add $2,$6
  add $5,1
  mul $1,$4
  div $1,$8
  div $2,$5
  add $3,1
lpe
mul $0,$2
add $0,$1
