; A046211: Number of ternary Lyndon words whose digits sum to 1 (or 2) mod 3; number of trace 1 (or 2) monic irreducible polynomials over GF(3).
; Submitted by [SG]KidDoesCrunch
; 1,1,3,6,16,39,104,270,729,1960,5368,14742,40880,113828,318864,896670,2532160,7174089,20390552,58112088,166037352,475467916,1364393896,3922625070,11297181456,32588003000,94143178827,272342710380,788854912240,2287679086056,6641649422408,19302293185470,56152126934904,163501780103200,476490905704736,1389765138051654,4056611764783760,11849576460620444,34637223530076720,101313878796417816,296528425830656800,868404675563904804,2544627654221217656,7460385622365380100,21883797826302471696

#offset 1

mov $2,$0
sub $0,1
mov $3,$0
bin $3,2
add $3,$0
add $3,$2
lpb $2
  sub $2,1
  mov $5,0
  mov $0,$3
  sub $0,$2
  mov $4,$0
  seq $4,54525 ; Triangle T(n,k): T(n,k) = mu(n/k) if k divides n, T(n,k) = 0 otherwise (n >= 1, 1 <= k <= n).
  sub $0,1
  lpb $0
    add $5,1
    sub $0,$5
  lpe
  add $0,1
  seq $0,364210 ; a(n) = (1/(2*n)) * Sum_{d|n} 3^(n/d-1) * phi(3*d).
  mul $0,$4
  add $1,$0
lpe
mov $0,$1
